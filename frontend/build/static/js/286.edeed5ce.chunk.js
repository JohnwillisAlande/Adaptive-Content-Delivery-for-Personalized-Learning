"use strict";(self.webpackChunkapex101_frontend=self.webpackChunkapex101_frontend||[]).push([[286],{286:(e,a,t)=>{t.r(a),t.d(a,{default:()=>x});var s=t(555),r=t(43),i=t(439),o=t(488),l=t(710),n=t(204),c=t(768),d=t(697),u=t(579);const h={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GEMINI_API_KEY:"AIzaSyCrxqeqgsp8qubxzmo4Yvzzh7S7-0hzXEc",REACT_APP_GOOGLE_CLIENT_ID:"776006269077-683ndu3i60s7o3tu1bn1m1rb3mukc03u.apps.googleusercontent.com"}.REACT_APP_FILE_BASE_URL||"http://localhost:5000",m=e=>e?e.startsWith("blob:")||e.startsWith("http")?e:e.startsWith("/")?"".concat(h).concat(e):"".concat(h,"/uploaded_files/").concat(e):"",p=e=>{const a=(null===e||void 0===e?void 0:e.thumbnail)||(null===e||void 0===e?void 0:e.thumbUrl)||(null===e||void 0===e?void 0:e.thumb)||(null===e||void 0===e?void 0:e.backgroundImage);return a?a.startsWith("http")?a:a.startsWith("/")?"".concat(h).concat(a):"".concat(h,"/uploaded_files/").concat(a):"https://images.unsplash.com/photo-1523580846011-d3a5bc25702b?w=1200&q=80"},v={title:"",description:"",subtitle:"",backgroundImage:"",duration:"",featured:!1},b=e=>{var a,t,s;let{course:r,onViewCourse:i,onUploadMaterial:o,onEditCourse:l,onViewMaterial:n,onEditMaterial:c,onViewMetrics:d=()=>{}}=e;r.id||r._id;const h=r.title||r.name||"Untitled course",m=r.subtitle||r.tagline||"",v=r.description||r.summary||"",b=r.duration||r.length||"",x=null!==(a=null!==(t=r.materialCount)&&void 0!==t?t:r.lessons)&&void 0!==a?a:0,j=r.featured?"Featured course":"Not featured",_=()=>i(r);return(0,u.jsxs)("div",{className:"box my-course-card teacher-course-card",role:"button",tabIndex:0,onClick:_,onKeyDown:e=>{"Enter"===e.key&&_()},children:[(0,u.jsxs)("div",{className:"relative mb-4",children:[(0,u.jsx)("img",{src:p(r),alt:h,className:"thumb",style:{width:"100%",height:"200px",objectFit:"cover",borderRadius:"0.75rem"},loading:"lazy"}),(0,u.jsxs)("span",{className:"teacher-course-badge",children:[x," ",1===x?"lesson":"lessons"]})]}),(0,u.jsx)("div",{className:"title",children:h}),m&&(0,u.jsx)("div",{style:{color:"#8892b0",marginBottom:"0.5rem"},children:m}),v&&(0,u.jsx)("div",{style:{marginBottom:"1rem",color:"#94a3b8"},children:v}),(0,u.jsxs)("div",{className:"my-course-meta",children:[b&&(0,u.jsx)("span",{children:b}),(0,u.jsx)("span",{children:j})]}),(0,u.jsxs)("div",{className:"teacher-course-actions",children:[(0,u.jsx)("button",{type:"button",className:"inline-btn",onClick:e=>{e.stopPropagation(),_()},children:"Open course"}),(0,u.jsx)("button",{type:"button",className:"inline-option-btn",onClick:e=>{e.stopPropagation(),o(r)},children:"Upload material"}),(0,u.jsx)("button",{type:"button",className:"inline-option-btn",onClick:e=>{e.stopPropagation(),l(r)},children:"Edit details"}),(0,u.jsx)("button",{type:"button",className:"inline-option-btn",onClick:e=>{e.stopPropagation(),d(r)},children:"View course metrics"})]}),(0,u.jsxs)("div",{className:"teacher-course-materials",children:[(0,u.jsxs)("div",{className:"teacher-course-materials__header",children:[(0,u.jsx)("span",{children:"Materials"}),(0,u.jsxs)("span",{className:"teacher-course-materials__count",children:[x," ",1===x?"item":"items"]})]}),null!==(s=r.materials)&&void 0!==s&&s.length?(0,u.jsx)("div",{className:"teacher-course-materials__scroll",children:r.materials.map(e=>{var a;return(0,u.jsxs)("div",{className:"teacher-course-material",children:[(0,u.jsxs)("div",{className:"teacher-course-material__meta",children:[(0,u.jsx)("strong",{children:e.title}),(0,u.jsxs)("span",{children:["Lesson ",e.order," - ",(null===(a=e.annotations)||void 0===a?void 0:a.category)||"Material"]})]}),(0,u.jsxs)("div",{className:"teacher-course-material__actions",children:[(0,u.jsx)("button",{type:"button",className:"inline-option-btn",onClick:a=>{a.stopPropagation(),n(r,e)},children:"View"}),(0,u.jsx)("button",{type:"button",className:"inline-option-btn",onClick:a=>{a.stopPropagation(),c(r,e)},children:"Edit"})]})]},e._id)})}):(0,u.jsx)("div",{className:"teacher-course-materials__empty",children:"No materials yet. Upload one to get started."})]})]})};const x=function(){var e,a,t;const h=(0,i.Zp)(),{user:p,isAuthenticated:x,initializing:j}=(0,d.A)(),_=(0,r.useMemo)(()=>"Teacher"===(null===p||void 0===p?void 0:p.userType),[null===p||void 0===p?void 0:p.userType]),[g,f]=(0,r.useState)([]),[N,w]=(0,r.useState)(!0),[y,C]=(0,r.useState)(!1),[k,A]=(0,r.useState)(v),[E,S]=(0,r.useState)(null),[I,R]=(0,r.useState)(""),[T,U]=(0,r.useState)(null),[P,D]=(0,r.useState)(null),[F,z]=(0,r.useState)(null),[q,O]=(0,r.useState)(null),[L,M]=(0,r.useState)(null),[V,W]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!j)return x&&_?void B():(o.oR.error("Teacher access required"),void h("/home",{replace:!0}))},[j,x,_]);const B=async()=>{w(!0);try{const{data:e}=await c.A.get("/courses/teacher/my");f(Array.isArray(e)?e:[])}catch(t){var e,a;o.oR.error((null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.error)||"Failed to load courses")}finally{w(!1)}},K=()=>{A(v),S(null),R(""),U(null)},Y=e=>{const{name:a,value:t,type:r,checked:i}=e.target;A(e=>(0,s.A)((0,s.A)({},e),{},{[a]:"checkbox"===r?i:t}))};(0,r.useEffect)(()=>()=>{I&&I.startsWith("blob:")&&URL.revokeObjectURL(I)},[I]);const G=e=>{U(e._id),A({title:e.title||"",description:e.description||"",subtitle:e.subtitle||"",backgroundImage:e.backgroundImage||"",duration:e.duration||"",featured:Boolean(e.featured)}),S(null),R(m(e.thumbUrl||"")),window.scrollTo({top:0,behavior:"smooth"})},H=e=>{h("/courses/".concat(e.id||e._id))},$=(e,a)=>{D(e),z(a),O(null)},Q=e=>{const a=(null===e||void 0===e?void 0:e._id)||(null===e||void 0===e?void 0:e.id);a&&h("/teacher/courses/".concat(a,"/metrics"))},X=()=>{z(null),D(null),O(null)};return j||!_?(0,u.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[#0f1117] text-white",children:(0,u.jsx)(l.A,{color:"#14b8a6",size:32})}):(0,u.jsx)("main",{className:"main-content",children:(0,u.jsxs)("div",{className:"page-shell",children:[(0,u.jsx)("section",{className:"course-hero animate-in",children:(0,u.jsxs)("div",{children:[(0,u.jsx)("h1",{className:"heading",children:"My courses"}),(0,u.jsx)("p",{className:"subheading",children:"Craft engaging learning experiences. Create new courses, update lessons and refine your materials in one place."})]})}),(0,u.jsx)("section",{className:"card animate-in teacher-course-form-section",children:(0,u.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!k.title.trim()||!k.description.trim())return void o.oR.error("Title and description are required");C(!0);const a=new FormData;a.append("title",k.title.trim()),a.append("description",k.description.trim()),k.subtitle&&a.append("subtitle",k.subtitle),k.backgroundImage&&a.append("backgroundImage",k.backgroundImage),k.duration&&a.append("duration",k.duration),a.append("featured",String(k.featured)),E&&a.append("thumb",E);try{T?(await c.A.put("/courses/teacher/".concat(T),a,{headers:{"Content-Type":"multipart/form-data"}}),o.oR.success("Course updated")):(await c.A.post("/courses/teacher",a,{headers:{"Content-Type":"multipart/form-data"}}),o.oR.success("Course created")),K(),B()}catch(r){var t,s;o.oR.error((null===(t=r.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.error)||"Failed to save course")}finally{C(!1)}},encType:"multipart/form-data",className:"form-card form-card--xl teacher-course-form",children:[(0,u.jsx)("h2",{className:"form-card__title form-card__title--left",children:T?"Update course":"Create a new course"}),(0,u.jsx)("p",{className:"form-card__subtitle form-card__subtitle--left",children:"Set the tone for your learners with a compelling title, concise subtitle and a clear course description."}),(0,u.jsxs)("div",{className:"form-row",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"course-title",children:"Course title"}),(0,u.jsx)("input",{id:"course-title",name:"title",value:k.title,onChange:Y,required:!0,placeholder:"Advanced Mathematics"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"course-subtitle",children:"Subtitle (optional)"}),(0,u.jsx)("input",{id:"course-subtitle",name:"subtitle",value:k.subtitle,onChange:Y,placeholder:"Give learners a short teaser"})]})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"course-description",children:"Description"}),(0,u.jsx)("textarea",{id:"course-description",name:"description",value:k.description,onChange:Y,required:!0,rows:4,placeholder:"Describe what students will learn in this course"})]}),(0,u.jsxs)("div",{className:"form-row",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"course-duration",children:"Duration (optional)"}),(0,u.jsx)("input",{id:"course-duration",name:"duration",value:k.duration,onChange:Y,placeholder:"e.g. 6 weeks"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"course-background",children:"Background image URL (optional)"}),(0,u.jsx)("input",{id:"course-background",name:"backgroundImage",value:k.backgroundImage,onChange:Y,placeholder:"https://..."})]})]}),(0,u.jsxs)("div",{className:"form-row",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"course-thumb",children:"Thumbnail"}),(0,u.jsx)("input",{id:"course-thumb",type:"file",accept:"image/*",onChange:e=>{var a;const t=null===(a=e.target.files)||void 0===a?void 0:a[0];S(t||null),R(e=>(e&&e.startsWith("blob:")&&URL.revokeObjectURL(e),t?URL.createObjectURL(t):e&&e.startsWith("blob:")?"":e))}}),I&&(0,u.jsx)("img",{src:I,alt:"Thumbnail preview",className:"form-preview"})]}),(0,u.jsxs)("div",{className:"form-checkbox",children:[(0,u.jsx)("input",{id:"featured",type:"checkbox",name:"featured",checked:k.featured,onChange:Y}),(0,u.jsx)("label",{htmlFor:"featured",children:"Mark as featured course"})]})]}),(0,u.jsxs)("div",{className:"form-actions",children:[(0,u.jsx)("button",{type:"submit",className:"btn",disabled:y,children:y?(0,u.jsx)(l.A,{color:"#fff",size:18}):T?"Update course":"Create course"}),T&&(0,u.jsx)("button",{type:"button",className:"option-btn",onClick:()=>{K()},children:"Cancel"}),T&&(0,u.jsx)("button",{type:"button",className:"delete-btn",onClick:()=>{T&&M({type:"course",courseId:T})},disabled:y,children:"Delete course"})]})]})}),"course"===(null===L||void 0===L?void 0:L.type)&&(0,u.jsx)("div",{className:"danger-modal",role:"dialog","aria-modal":"true",children:(0,u.jsxs)("div",{className:"danger-modal__card",children:[(0,u.jsx)("div",{className:"danger-modal__icon",children:(0,u.jsx)(n.BS8,{})}),(0,u.jsx)("h3",{className:"danger-modal__title",children:"Delete this course?"}),(0,u.jsx)("p",{className:"danger-modal__copy",children:"This will permanently delete the course and every material associated with it. This action cannot be undone."}),(0,u.jsxs)("div",{className:"danger-modal__actions",children:[(0,u.jsx)("button",{type:"button",className:"delete-btn",onClick:async()=>{if(L){W(!0);try{"course"===L.type&&(await c.A.delete("/courses/teacher/".concat(L.courseId)),o.oR.success("Course deleted"),K(),B())}catch(t){var e,a;o.oR.error((null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.error)||"Failed to delete course")}finally{W(!1),M(null)}}},disabled:V,children:V?(0,u.jsx)(l.A,{color:"#fff",size:18}):"Delete course"}),(0,u.jsx)("button",{type:"button",className:"option-btn",onClick:()=>{V||M(null)},disabled:V,children:"Cancel"})]})]})}),(0,u.jsx)("section",{className:"card animate-in teacher-course-list",children:N?(0,u.jsx)("div",{className:"teacher-course-list__loader",children:(0,u.jsx)(l.A,{color:"#14b8a6"})}):0===g.length?(0,u.jsx)("div",{className:"empty",children:"You haven't created any courses yet. Use the form above to publish your first course."}):(0,u.jsx)("div",{className:"box-container",children:g.map(e=>(0,u.jsx)(b,{course:e,onViewCourse:H,onUploadMaterial:e=>((e,a)=>{const t=a?"courseId=".concat(e._id,"&materialId=").concat(a._id):"courseId=".concat(e._id);h("/teacher/materials?".concat(t))})(e),onEditCourse:G,onViewMaterial:$,onEditMaterial:(e,a)=>h("/teacher/materials?courseId=".concat(e._id,"&materialId=").concat(a._id)),onViewMetrics:Q},e._id))})}),F&&(0,u.jsx)("div",{className:"teacher-preview-modal",role:"dialog","aria-modal":"true","aria-label":F.title,onClick:X,children:(0,u.jsxs)("div",{className:"teacher-preview-modal__content teacher-preview-modal__content--card",onClick:e=>e.stopPropagation(),children:[(0,u.jsx)("div",{className:"teacher-preview-modal__controls",children:(0,u.jsx)("button",{type:"button",className:"teacher-preview-modal__close",onClick:X,"aria-label":"Close preview",children:"\xd7"})}),(0,u.jsxs)("article",{className:"teacher-preview__item teacher-preview__item--single",children:[(0,u.jsxs)("header",{className:"teacher-preview__item-header",children:[(0,u.jsxs)("span",{className:"teacher-preview__badge",children:["Lesson ",null!==(e=F.order)&&void 0!==e?e:"\u2014"]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{children:F.title}),(0,u.jsxs)("div",{className:"teacher-preview__meta",children:[(null===(a=F.annotations)||void 0===a?void 0:a.category)&&(0,u.jsx)("span",{children:F.annotations.category}),(null===(t=F.annotations)||void 0===t?void 0:t.format)&&(0,u.jsx)("span",{children:F.annotations.format}),F.fileUrl&&(0,u.jsx)("a",{href:m(F.fileUrl),target:"_blank",rel:"noreferrer",children:"Download"})]})]})]}),(0,u.jsx)("div",{className:"teacher-preview__body",children:(e=>{var a,t;if(!e)return null;const s=(null===(a=e.annotations)||void 0===a?void 0:a.category)||"",r=(null===(t=e.annotations)||void 0===t?void 0:t.format)||"",i=m(e.fileUrl||e.file),o=m(e.video||e.videoUrl),l=e.textContent,n=i&&/\.pdf($|#|\?)/i.test(i),c=i&&/\.(mp3|m4a|aac|wav|ogg)$/i.test(i),d=o&&/\.(mp4|webm|ogg)$/i.test(o);if(e.video||"Video"===s||d){const e=o||i;return e?(0,u.jsxs)("video",{controls:!0,className:"teacher-preview__media",children:[(0,u.jsx)("source",{src:e}),"Your browser does not support the video tag."]}):(0,u.jsx)("p",{className:"teacher-preview__placeholder",children:"Video unavailable."})}if("Audio"===s||"Audio"===r||c){const e=i||o;return e?(0,u.jsxs)("audio",{controls:!0,className:"teacher-preview__media",children:[(0,u.jsx)("source",{src:e}),"Your browser does not support the audio element."]}):(0,u.jsx)("p",{className:"teacher-preview__placeholder",children:"Audio unavailable."})}if(n)return(0,u.jsxs)("div",{className:"teacher-preview__pdf-wrapper",children:[(0,u.jsx)("iframe",{title:e.title,src:"".concat(i,"#toolbar=0"),className:"teacher-preview__pdf"}),(0,u.jsx)("button",{type:"button",className:"teacher-preview__expand",onClick:e=>{e.stopPropagation(),O(i)},"aria-label":"Expand PDF",children:"\u2197"})]});if("Reading"===s||"Outline"===s||"Verbal"===r){if(l)return(0,u.jsx)("div",{className:"teacher-preview__text",children:l.split("\n").map((e,a)=>(0,u.jsx)("p",{children:e},"paragraph-".concat(a)))});if(i)return(0,u.jsx)("a",{href:i,target:"_blank",rel:"noreferrer",className:"inline-btn teacher-preview__link",children:"Open document"})}return"Flashcards"===s&&Array.isArray(e.quizData)&&e.quizData.length?(0,u.jsx)("ul",{className:"teacher-preview__flashcards",children:e.quizData.map((e,a)=>(0,u.jsxs)("li",{children:[(0,u.jsx)("strong",{children:e.question||e.front||"Card ".concat(a+1)}),(0,u.jsx)("span",{children:e.answer||e.options&&e.options[e.correctIndex]||e.back})]},"card-".concat(a)))}):"Quiz"===s?(0,u.jsx)("div",{className:"teacher-preview__quiz",children:(0,u.jsxs)("p",{children:["This lesson contains a quiz with ",(null===(h=e.quizData)||void 0===h?void 0:h.length)||0," questions."]})}):(0,u.jsxs)("p",{className:"teacher-preview__placeholder",children:["Preview not available."," ",i||o?(0,u.jsx)("a",{href:i||o,target:"_blank",rel:"noreferrer",children:"Open resource"}):"Resource missing."]});var h})(F)})]}),(0,u.jsx)("div",{className:"teacher-preview__actions",children:(0,u.jsx)("button",{type:"button",className:"inline-option-btn",onClick:()=>{if(!P||!F)return;const e=P.id||P._id,a=F.id||F._id;X(),h("/courses/".concat(e,"/materials/").concat(a))},children:"Open full page"})})]})}),q&&(0,u.jsx)("div",{className:"teacher-preview-modal",role:"dialog","aria-modal":"true","aria-label":"Expanded PDF",onClick:()=>O(null),children:(0,u.jsxs)("div",{className:"teacher-preview-modal__content",onClick:e=>e.stopPropagation(),children:[(0,u.jsx)("div",{className:"teacher-preview-modal__controls",children:(0,u.jsx)("button",{type:"button",className:"teacher-preview-modal__close",onClick:()=>O(null),"aria-label":"Close full size preview",children:"\xd7"})}),(0,u.jsx)("div",{className:"teacher-preview-modal__body",children:(0,u.jsx)("iframe",{title:"Expanded lesson preview",src:"".concat(q,"#toolbar=1"),className:"teacher-preview-modal__frame"})})]})})]})})}}}]);
//# sourceMappingURL=286.edeed5ce.chunk.js.map