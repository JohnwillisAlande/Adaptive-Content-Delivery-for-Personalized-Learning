"use strict";(self.webpackChunkapex101_frontend=self.webpackChunkapex101_frontend||[]).push([[188],{188:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var o=s(555),r=s(43),a=s(439),n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])},n(e,t)};var l=function(){return l=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++)for(var r in t=arguments[s])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},l.apply(this,arguments)};var i="Pixel",c="Percent",d={unit:c,value:.8};function h(e){return"number"===typeof e?{unit:c,value:100*e}:"string"===typeof e?e.match(/^(\d*(\.\d+)?)px$/)?{unit:i,value:parseFloat(e)}:e.match(/^(\d*(\.\d+)?)%$/)?{unit:c,value:parseFloat(e)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),d):(console.warn("scrollThreshold should be string or number"),d)}const u=function(e){function t(t){var s=e.call(this,t)||this;return s.lastScrollTop=0,s.actionTriggered=!1,s.startY=0,s.currentY=0,s.dragging=!1,s.maxPullDownDistance=0,s.getScrollableTarget=function(){return s.props.scrollableTarget instanceof HTMLElement?s.props.scrollableTarget:"string"===typeof s.props.scrollableTarget?document.getElementById(s.props.scrollableTarget):(null===s.props.scrollableTarget&&console.warn("You are trying to pass scrollableTarget but it is null. This might\n        happen because the element may not have been added to DOM yet.\n        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.\n      "),null)},s.onStart=function(e){s.lastScrollTop||(s.dragging=!0,e instanceof MouseEvent?s.startY=e.pageY:e instanceof TouchEvent&&(s.startY=e.touches[0].pageY),s.currentY=s.startY,s._infScroll&&(s._infScroll.style.willChange="transform",s._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},s.onMove=function(e){s.dragging&&(e instanceof MouseEvent?s.currentY=e.pageY:e instanceof TouchEvent&&(s.currentY=e.touches[0].pageY),s.currentY<s.startY||(s.currentY-s.startY>=Number(s.props.pullDownToRefreshThreshold)&&s.setState({pullToRefreshThresholdBreached:!0}),s.currentY-s.startY>1.5*s.maxPullDownDistance||s._infScroll&&(s._infScroll.style.overflow="visible",s._infScroll.style.transform="translate3d(0px, "+(s.currentY-s.startY)+"px, 0px)")))},s.onEnd=function(){s.startY=0,s.currentY=0,s.dragging=!1,s.state.pullToRefreshThresholdBreached&&(s.props.refreshFunction&&s.props.refreshFunction(),s.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame(function(){s._infScroll&&(s._infScroll.style.overflow="auto",s._infScroll.style.transform="none",s._infScroll.style.willChange="unset")})},s.onScrollListener=function(e){"function"===typeof s.props.onScroll&&setTimeout(function(){return s.props.onScroll&&s.props.onScroll(e)},0);var t=s.props.height||s._scrollableNode?e.target:document.documentElement.scrollTop?document.documentElement:document.body;s.actionTriggered||((s.props.inverse?s.isElementAtTop(t,s.props.scrollThreshold):s.isElementAtBottom(t,s.props.scrollThreshold))&&s.props.hasMore&&(s.actionTriggered=!0,s.setState({showLoader:!0}),s.props.next&&s.props.next()),s.lastScrollTop=t.scrollTop)},s.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:t.dataLength},s.throttledOnScrollListener=function(e,t,s,o){var r,a=!1,n=0;function l(){r&&clearTimeout(r)}function i(){var i=this,c=Date.now()-n,d=arguments;function h(){n=Date.now(),s.apply(i,d)}a||(o&&!r&&h(),l(),void 0===o&&c>e?h():!0!==t&&(r=setTimeout(o?function(){r=void 0}:h,void 0===o?e-c:e)))}return"boolean"!==typeof t&&(o=s,s=t,t=void 0),i.cancel=function(){l(),a=!0},i}(150,s.onScrollListener).bind(s),s.onStart=s.onStart.bind(s),s.onMove=s.onMove.bind(s),s.onEnd=s.onEnd.bind(s),s}return function(e,t){function s(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}(t,e),t.prototype.componentDidMount=function(){if("undefined"===typeof this.props.dataLength)throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),"number"===typeof this.props.initialScrollY&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),"function"!==typeof this.props.refreshFunction))throw new Error('Mandatory prop "refreshFunction" missing.\n          Pull Down To Refresh functionality will not work\n          as expected. Check README.md for usage\'')},t.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},t.prototype.componentDidUpdate=function(e){this.props.dataLength!==e.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},t.getDerivedStateFromProps=function(e,t){return e.dataLength!==t.prevDataLength?l(l({},t),{prevDataLength:e.dataLength}):null},t.prototype.isElementAtTop=function(e,t){void 0===t&&(t=.8);var s=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,o=h(t);return o.unit===i?e.scrollTop<=o.value+s-e.scrollHeight+1:e.scrollTop<=o.value/100+s-e.scrollHeight+1},t.prototype.isElementAtBottom=function(e,t){void 0===t&&(t=.8);var s=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,o=h(t);return o.unit===i?e.scrollTop+s>=e.scrollHeight-o.value:e.scrollTop+s>=o.value/100*e.scrollHeight},t.prototype.render=function(){var e=this,t=l({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),s=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),o=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return r.createElement("div",{style:o,className:"infinite-scroll-component__outerdiv"},r.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(t){return e._infScroll=t},style:t},this.props.pullDownToRefresh&&r.createElement("div",{style:{position:"relative"},ref:function(t){return e._pullDown=t}},r.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!s&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},t}(r.Component);var p=s(939),m=s.n(p),v=s(204),f=s(488),x=s(768),g=s(697),b=s(579);const _={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GEMINI_API_KEY:"AIzaSyCrxqeqgsp8qubxzmo4Yvzzh7S7-0hzXEc",REACT_APP_GOOGLE_CLIENT_ID:"776006269077-683ndu3i60s7o3tu1bn1m1rb3mukc03u.apps.googleusercontent.com"}.REACT_APP_FILE_BASE_URL||"http://localhost:5000",j=[{key:"All",label:"All"},{key:"Visual",label:"Visual"},{key:"Verbal",label:"Verbal"},{key:"Audio",label:"Audio"}],w=e=>e?e.startsWith("blob:")||e.startsWith("http")?e:e.startsWith("/")?"".concat(_).concat(e):"".concat(_,"/uploaded_files/").concat(e):"",y=r.memo(()=>{const{courseId:e}=(0,a.g)(),t=(0,a.Zp)(),{user:s,isAuthenticated:n,initializing:l}=(0,g.A)(),[i,c]=(0,r.useState)(null),[d,h]=(0,r.useState)([]),[p,y]=(0,r.useState)("All"),[N,E]=(0,r.useState)(""),[S,T]=(0,r.useState)(1),[k,L]=(0,r.useState)(!0),[C,A]=(0,r.useState)(!0),[D,R]=(0,r.useState)(!1),[M,P]=(0,r.useState)(0),[Y,O]=(0,r.useState)(!1),[z,F]=(0,r.useState)(null),[B,H]=(0,r.useState)(0),[I,q]=(0,r.useState)(!1),[U,V]=(0,r.useState)(!0),[W,K]=(0,r.useState)([]),[G,$]=(0,r.useState)(""),[X,Q]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l||n||(f.oR.error("Please login to view course materials"),t("/login",{replace:!0}))},[l,n,t]),(0,r.useEffect)(()=>{if(!n||l)return;let t=!0;return(async()=>{A(!0);try{var s,o;const{data:r}=await x.A.get("/courses/".concat(e),{params:{page:S,search:N,format:p}});if(!t)return;c(r.course||null),R(Boolean(r.enrollmentRequired));const a=Array.isArray(r.materials)?r.materials:[];h(1===S?a:e=>[...e,...a]);const n=r.pagination||{},l=null!==(s=n.totalItems)&&void 0!==s?s:a.length,i=null!==(o=n.pageSize)&&void 0!==o?o:12;L(!r.enrollmentRequired&&S*i<l)}catch(n){var r,a;if(!t)return;f.oR.error((null===(r=n.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.error)||"Failed to load materials")}finally{t&&A(!1)}})(),()=>{t=!1}},[e,S,N,p,M,n,l]),(0,r.useEffect)(()=>{T(1),h([]),L(!0)},[N,p]);const Z=(0,r.useCallback)(e=>{if(!e)return"";try{return new Date(e).toLocaleString()}catch(t){return""}},[]),J=(0,r.useCallback)(async()=>{V(!0);try{const{data:t}=await x.A.get("/courses/".concat(e,"/social"));H((null===t||void 0===t?void 0:t.likesCount)||0),q(Boolean(null===t||void 0===t?void 0:t.hasLiked)),K(Array.isArray(null===t||void 0===t?void 0:t.comments)?t.comments:[])}catch(o){var t,s;console.warn("Failed to load course feedback",o),H(0),q(!1),K([]),f.oR.error((null===(t=o.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.error)||"Failed to load course feedback")}finally{V(!1)}},[e]);(0,r.useEffect)(()=>{J()},[J]);const ee=(0,r.useCallback)(async()=>{if(!n)return f.oR.info("Please login to like this course"),void t("/login");try{var s;const{data:t}=await x.A.post("/courses/".concat(e,"/like"));q(Boolean(null===t||void 0===t?void 0:t.liked)),H(null!==(s=null===t||void 0===t?void 0:t.likesCount)&&void 0!==s?s:0)}catch(a){var o,r;f.oR.error((null===(o=a.response)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.error)||"Unable to update like")}},[e,n,t]),te=async()=>{if(!s)return f.oR.error("Please login to enroll"),void t("/login");O(!0);try{await x.A.post("/courses/enroll/".concat(e)),f.oR.success("Enrollment successful!"),R(!1),c(e=>e?(0,o.A)((0,o.A)({},e),{},{isEnrolled:!0}):e),P(e=>e+1),T(1)}catch(n){var r,a;f.oR.error((null===(r=n.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.error)||"Failed to enroll")}finally{O(!1)}},se=(0,r.useMemo)(()=>i?Math.max(0,Math.min(100,i.progressPercent||0)):0,[i]),oe=!D,re="Student"===(null===s||void 0===s?void 0:s.userType),ae="Teacher"===(null===s||void 0===s?void 0:s.userType),ne="Admin"===(null===s||void 0===s?void 0:s.userType),le=(0,r.useMemo)(()=>[...d].sort((e,t)=>{var s,o;const r=null!==(s=e.order)&&void 0!==s?s:Number.MAX_SAFE_INTEGER,a=null!==(o=t.order)&&void 0!==o?o:Number.MAX_SAFE_INTEGER;if(r!==a)return r-a;return(e.date?new Date(e.date).getTime():0)-(t.date?new Date(t.date).getTime():0)}),[d]),ie=e=>{var t,s;const r=(null===(t=e.annotations)||void 0===t?void 0:t.category)||"",a=(null===(s=e.annotations)||void 0===s?void 0:s.format)||"",n=w(e.fileUrl),l=w(e.video),i=e.textContent,c=n&&/\.pdf($|#|\?)/i.test(n),d=n&&/\.(mp3|m4a|aac|wav|ogg)$/i.test(n),h=l&&/\.(mp4|webm|ogg)$/i.test(l);if(e.video||"Video"===r||h){const e=l||n;return e?(0,b.jsxs)("video",{controls:!0,className:"teacher-preview__media",children:[(0,b.jsx)("source",{src:e}),"Your browser does not support the video tag."]}):(0,b.jsx)("p",{className:"teacher-preview__placeholder",children:"Video unavailable."})}if("Audio"===r||"Audio"===a||d){const e=n||l;return e?(0,b.jsxs)("audio",{controls:!0,className:"teacher-preview__media",children:[(0,b.jsx)("source",{src:e}),"Your browser does not support the audio element."]}):(0,b.jsx)("p",{className:"teacher-preview__placeholder",children:"Audio unavailable."})}if(c)return(0,b.jsxs)("div",{className:"teacher-preview__pdf-wrapper",children:[(0,b.jsx)("iframe",{title:e.title,src:"".concat(n,"#toolbar=0"),className:"teacher-preview__pdf"}),(0,b.jsx)("button",{type:"button",className:"teacher-preview__expand",onClick:t=>{t.stopPropagation(),F((0,o.A)((0,o.A)({},e),{},{assetUrl:n,mode:"pdf"}))},"aria-label":"Expand PDF",children:"\u2197"})]});if("Reading"===r||"Outline"===r||"Verbal"===a){if(i)return(0,b.jsx)("div",{className:"teacher-preview__text",children:i.split("\n").map((e,t)=>(0,b.jsx)("p",{children:e},"paragraph-".concat(t)))});if(n)return(0,b.jsx)("a",{href:n,target:"_blank",rel:"noreferrer",className:"inline-btn teacher-preview__link",children:"Open document"})}return"Flashcards"===r&&Array.isArray(e.quizData)&&e.quizData.length?(0,b.jsx)("ul",{className:"teacher-preview__flashcards",children:e.quizData.map((e,t)=>(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:e.question||e.front||"Card ".concat(t+1)}),(0,b.jsx)("span",{children:e.answer||e.options&&e.options[e.correctIndex]||e.back})]},"card-".concat(t)))}):"Quiz"===r?(0,b.jsx)("div",{className:"teacher-preview__quiz",children:(0,b.jsxs)("p",{children:["This lesson contains a quiz with ",(null===(u=e.quizData)||void 0===u?void 0:u.length)||0," questions."]})}):(0,b.jsxs)("p",{className:"teacher-preview__placeholder",children:["Preview not available."," ",n||l?(0,b.jsx)("a",{href:n||l,target:"_blank",rel:"noreferrer",children:"Open resource"}):"Resource missing."]});var u};return C&&1===S?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[#0f1117] text-white",children:(0,b.jsx)(m(),{color:"#14b8a6",size:32})}):(0,b.jsxs)("section",{className:"courses",style:{minHeight:"100vh"},children:[(0,b.jsxs)("div",{className:"course-detail-nav-wrapper",children:[(0,b.jsxs)("div",{className:"courses-nav course-detail-nav",children:[(0,b.jsx)("button",{type:"button",className:"course-detail-back",onClick:()=>{"undefined"!==typeof window&&window.history.length>1?t(-1):t("/courses")},"aria-label":"Back to previous page",children:(0,b.jsx)(v.QVr,{})}),j.map(e=>(0,b.jsx)("button",{type:"button",className:"nav-btn".concat(p===e.key?" active":""),onClick:()=>{var t;(t=e.key)!==p&&y(t)},children:e.label},e.key))]}),i&&(0,b.jsx)("span",{className:"course-detail-nav-course",children:i.title})]}),i&&(0,b.jsxs)("header",{className:"bg-[#1a1d2e] p-6 rounded-2xl shadow-lg mb-6 space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-white mb-1",children:i.title}),i.subtitle&&(0,b.jsx)("p",{className:"text-slate-300",children:i.subtitle})]}),re&&!i.isEnrolled&&(0,b.jsx)("button",{type:"button",className:"inline-btn",onClick:te,disabled:Y,children:Y?"Enrolling...":"Enroll to Unlock"})]}),i.description&&(0,b.jsx)("p",{className:"text-slate-400",children:i.description}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-400 mb-1",children:[(0,b.jsx)("span",{children:"Progress"}),(0,b.jsxs)("span",{children:[se,"%"]})]}),(0,b.jsx)("div",{className:"w-full bg-[#0f172a] rounded-full h-3 overflow-hidden",children:(0,b.jsx)("div",{className:"bg-teal-400 h-full transition-all duration-500",style:{width:"".concat(se,"%")}})})]})]}),(0,b.jsxs)("div",{className:"course-social-card",children:[(0,b.jsxs)("button",{type:"button",className:"course-social-like".concat(I?" course-social-like--active":""),onClick:ee,disabled:U,children:[I?(0,b.jsx)(v.Mbv,{}):(0,b.jsx)(v.sOK,{}),(0,b.jsx)("span",{children:U?"\u2014":"".concat(B," ").concat(1===B?"Like":"Likes")})]}),(0,b.jsxs)("div",{className:"course-social-summary",children:[(0,b.jsx)(v.Nhu,{}),(0,b.jsx)("span",{children:U?"Loading comments...":"".concat(W.length," ").concat(1===W.length?"Comment":"Comments")})]})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-4 mb-6",children:(0,b.jsx)("input",{type:"text",value:N,onChange:e=>{E(e.target.value)},placeholder:"Search materials...",className:"flex-1 min-w-[220px] px-4 py-2 rounded bg-[#1a1d2e] text-white focus:ring-2 focus:ring-teal-400","aria-label":"Search materials"})}),D&&(0,b.jsxs)("div",{className:"bg-[#1f2937] border border-dashed border-teal-500 rounded-2xl p-8 text-center text-slate-300 mb-8",children:[(0,b.jsx)("p",{className:"text-lg font-semibold text-white mb-3",children:"Enroll to unlock personalized materials for this course."}),re?(0,b.jsx)("button",{type:"button",className:"inline-btn",onClick:te,disabled:Y,children:Y?"Enrolling...":"Enroll Now"}):(0,b.jsx)("p",{children:"Login with a student account to enroll."})]}),!ae&&(d.length||C?(0,b.jsx)(u,{dataLength:d.length,next:()=>{k&&!C&&T(e=>e+1)},hasMore:k,loader:(0,b.jsx)("div",{className:"flex justify-center py-6",children:(0,b.jsx)(m(),{color:"#14b8a6"})}),className:ne?"admin-materials-list":"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:d.map(s=>{var o,r,a;const n=((e,t)=>e?e.startsWith("http")?e:e.startsWith("/")?"".concat(_).concat(e):"".concat(_,"/uploaded_files/").concat(e):t||"https://via.placeholder.com/640x360/111827/ffffff?text=Material")(s.thumb,null===i||void 0===i?void 0:i.backgroundImage),l=Boolean(s.isCompleted),c=s._id||s.id;var d,h,u;return ne?(0,b.jsxs)("article",{className:"admin-material-card ".concat(oe?"":"admin-material-card--disabled"),onClick:()=>oe&&t("/courses/".concat(e,"/materials/").concat(c)),onKeyPress:s=>{"Enter"===s.key&&oe&&t("/courses/".concat(e,"/materials/").concat(c))},role:"button",tabIndex:0,children:[(0,b.jsxs)("div",{className:"admin-material-card__thumb-wrapper",children:[(0,b.jsx)("img",{src:n,alt:s.title,className:"admin-material-card__thumb",loading:"lazy"}),(0,b.jsx)("div",{className:"admin-material-card__tag",children:(null===(d=s.annotations)||void 0===d?void 0:d.category)||"Material"})]}),(0,b.jsxs)("div",{className:"admin-material-card__body",children:[(0,b.jsxs)("div",{className:"admin-material-card__header",children:[(0,b.jsx)("h3",{children:s.title}),l&&(0,b.jsx)("span",{className:"admin-material-card__status","aria-label":"Completed",children:(0,b.jsx)(v.CMH,{})})]}),(0,b.jsx)("p",{className:"admin-material-card__description",children:s.description}),(0,b.jsxs)("div",{className:"admin-material-card__meta",children:[(null===(h=s.annotations)||void 0===h?void 0:h.format)&&(0,b.jsx)("span",{children:s.annotations.format}),(null===(u=s.annotations)||void 0===u?void 0:u.type)&&(0,b.jsx)("span",{children:s.annotations.type}),"number"===typeof s.order&&s.order>0&&(0,b.jsxs)("span",{children:["Lesson ",s.order]})]}),(0,b.jsx)("div",{className:"admin-material-card__actions",children:(0,b.jsx)("button",{type:"button",className:"inline-btn",onClick:s=>{s.stopPropagation(),oe&&t("/courses/".concat(e,"/materials/").concat(c))},children:"View material"})})]})]},c):(0,b.jsxs)("article",{className:"relative bg-[#1a1d2e] rounded-2xl overflow-hidden shadow-lg border border-transparent hover:border-teal-500 transition ".concat(oe?"cursor-pointer":"opacity-60 pointer-events-none"),onClick:()=>oe&&t("/courses/".concat(e,"/materials/").concat(c)),onKeyPress:s=>{"Enter"===s.key&&oe&&t("/courses/".concat(e,"/materials/").concat(c))},role:"button",tabIndex:0,children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("img",{src:n,alt:s.title,className:"w-full h-48 object-cover",loading:"lazy"}),(0,b.jsx)("div",{className:"absolute top-3 left-3 bg-black/70 text-xs uppercase tracking-widest px-3 py-1 rounded-full",children:(null===(o=s.annotations)||void 0===o?void 0:o.category)||"Material"}),l&&(0,b.jsx)("span",{className:"absolute top-3 right-3 bg-teal-500 text-white p-2 rounded-full shadow",children:(0,b.jsx)(v.CMH,{})})]}),(0,b.jsxs)("div",{className:"p-5 space-y-3",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold text-white",children:s.title}),(0,b.jsx)("p",{className:"text-sm text-slate-300 line-clamp-2",children:s.description}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs text-slate-400",children:[(null===(r=s.annotations)||void 0===r?void 0:r.format)&&(0,b.jsx)("span",{children:s.annotations.format}),(null===(a=s.annotations)||void 0===a?void 0:a.type)&&(0,b.jsx)("span",{children:s.annotations.type}),"number"===typeof s.order&&s.order>0&&(0,b.jsxs)("span",{children:["Lesson ",s.order]})]})]})]},c)})}):D?null:(0,b.jsx)("p",{className:"empty",children:"No materials available yet."})),ae&&le.length>0&&(0,b.jsxs)("section",{className:"teacher-preview",children:[(0,b.jsx)("h2",{className:"teacher-preview__title",children:"Course Materials (Teacher View)"}),(0,b.jsx)("p",{className:"teacher-preview__subtitle",children:"Review every resource without opening each lesson individually. Materials appear in upload order."}),(0,b.jsx)("div",{className:"teacher-preview__list",children:le.map(e=>{var t,s,o;return(0,b.jsxs)("article",{className:"teacher-preview__item",children:[(0,b.jsxs)("header",{className:"teacher-preview__item-header",children:[(0,b.jsxs)("span",{className:"teacher-preview__badge",children:["Lesson ",null!==(t=e.order)&&void 0!==t?t:"-"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{children:e.title}),(0,b.jsxs)("div",{className:"teacher-preview__meta",children:[(null===(s=e.annotations)||void 0===s?void 0:s.category)&&(0,b.jsx)("span",{children:e.annotations.category}),(null===(o=e.annotations)||void 0===o?void 0:o.format)&&(0,b.jsx)("span",{children:e.annotations.format}),e.fileUrl&&(0,b.jsx)("a",{href:w(e.fileUrl),target:"_blank",rel:"noreferrer",children:"Download"})]})]})]}),(0,b.jsx)("div",{className:"teacher-preview__body",children:ie(e)})]},"preview-".concat(e._id||e.id))})})]}),(0,b.jsxs)("section",{className:"course-comments-card",children:[(0,b.jsx)("h2",{className:"course-comments-card__title",children:"Course Discussion"}),n?(0,b.jsxs)("form",{className:"course-comments-card__form",onSubmit:async s=>{if(s.preventDefault(),!n)return f.oR.info("Please login to comment on this course"),void t("/login");const o=G.trim();if(o)if(o.length>1e3)f.oR.warn("Comment is too long");else{Q(!0);try{const{data:t}=await x.A.post("/courses/".concat(e,"/comments"),{comment:o});K(e=>[t,...e]),$("")}catch(l){var r,a;f.oR.error((null===(r=l.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.error)||"Failed to post comment")}finally{Q(!1)}}else f.oR.warn("Enter a comment before submitting")},children:[(0,b.jsx)("textarea",{value:G,onChange:e=>$(e.target.value),placeholder:"Share a thought, question, or insight about this course...",rows:3,className:"course-comments-card__textarea","aria-label":"Add a comment",disabled:X}),(0,b.jsx)("div",{className:"course-comments-card__actions",children:(0,b.jsx)("button",{type:"submit",className:"inline-btn",disabled:X,children:X?"Posting...":"Post comment"})})]}):(0,b.jsxs)("p",{className:"course-comments-card__cta",children:[(0,b.jsx)(a.N_,{to:"/login",className:"inline-option-btn",children:"Log in"})," to join the conversation."]}),U?(0,b.jsx)("div",{className:"flex justify-center py-6",children:(0,b.jsx)(m(),{color:"#14b8a6",size:24})}):0===W.length?(0,b.jsx)("p",{className:"course-comments-card__empty",children:"No comments yet. Be the first to start the discussion."}):(0,b.jsx)("ul",{className:"course-comments-card__list",children:W.map(e=>(0,b.jsxs)("li",{className:"course-comments-card__item",children:[(0,b.jsxs)("div",{className:"course-comments-card__meta",children:[(0,b.jsx)("span",{className:"course-comments-card__author",children:e.userName||"Learner"}),(0,b.jsx)("time",{className:"course-comments-card__date",children:Z(e.createdAt)})]}),(0,b.jsx)("p",{className:"course-comments-card__text",children:e.comment})]},e.id))})]}),z&&(0,b.jsx)("div",{className:"teacher-preview-modal",role:"dialog","aria-modal":"true","aria-label":z.title,onClick:()=>F(null),children:(0,b.jsxs)("div",{className:"teacher-preview-modal__content",onClick:e=>e.stopPropagation(),children:[(0,b.jsx)("div",{className:"teacher-preview-modal__controls",children:(0,b.jsx)("button",{type:"button",className:"teacher-preview-modal__close",onClick:()=>F(null),"aria-label":"Close full size preview",children:"\ufffd"})}),(0,b.jsx)("h3",{children:z.title}),(0,b.jsx)("div",{className:"teacher-preview-modal__body",children:"pdf"===z.mode&&(0,b.jsx)("iframe",{title:"".concat(z.title," full preview"),src:"".concat(w(z.assetUrl),"#toolbar=1"),className:"teacher-preview-modal__frame"})})]})})]})})}}]);
//# sourceMappingURL=188.55aca705.chunk.js.map