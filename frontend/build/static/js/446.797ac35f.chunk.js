"use strict";(self.webpackChunkapex101_frontend=self.webpackChunkapex101_frontend||[]).push([[446],{446:(e,s,n)=>{n.r(s),n.d(s,{default:()=>h});var l=n(43),d=n(439),i=n(939),r=n.n(i),a=n(488),t=n(204),o=n(768),c=n(697),u=n(579);const m=e=>e?new Date(e).toLocaleString():"\u2014";const h=function(){var e,s,n,i;const{user:h}=(0,c.A)(),x=(0,d.Zp)(),[j,v]=(0,l.useState)({running:!1,checkedAt:null,message:""}),[g,_]=(0,l.useState)([]),[p,f]=(0,l.useState)(null),[N,y]=(0,l.useState)(!0),[k,A]=(0,l.useState)(null);(0,l.useEffect)(()=>{if("Admin"!==(null===h||void 0===h?void 0:h.userType))return a.oR.error("Administrators only"),void x("/home",{replace:!0});let e=!0;const s=async()=>{y(!0);try{const[{data:s},{data:n}]=await Promise.all([o.A.get("/model/status"),o.A.get("/admin/model/logs")]);if(!e)return;v(s),_(Array.isArray(n.logs)?n.logs:[]),f(n.metrics||null)}catch(l){var s,n;if(!e)return;a.oR.error((null===(s=l.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.error)||"Failed to load model metrics")}finally{e&&y(!1)}};s();const n=setInterval(s,2e4);return()=>{e=!1,clearInterval(n)}},[null===h||void 0===h?void 0:h.userType,x]);const b=(0,l.useMemo)(()=>j?j.running?"Model Running":"Model Offline":"Unknown",[j]);return N?(0,u.jsx)("div",{className:"admin-model admin-teacher-detail--loading",children:(0,u.jsx)(r(),{color:"#14b8a6",size:48})}):(0,u.jsxs)("div",{className:"admin-model",children:[(0,u.jsxs)("header",{className:"admin-model__header",children:[(0,u.jsxs)("div",{className:"admin-model__status".concat(j.running?" admin-model__status--online":" admin-model__status--offline"),children:[(0,u.jsx)(t.vwk,{}),(0,u.jsxs)("div",{children:[(0,u.jsx)("strong",{children:b}),(0,u.jsxs)("span",{children:["Checked ",m(j.checkedAt)]}),j.message&&(0,u.jsx)("small",{children:j.message})]})]}),p&&(0,u.jsxs)("div",{className:"admin-model__metrics",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{children:"Total Requests"}),(0,u.jsx)("strong",{children:null!==(e=p.totalRequests)&&void 0!==e?e:0})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{children:"Success"}),(0,u.jsx)("strong",{children:null!==(s=p.successCount)&&void 0!==s?s:0})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{children:"Failures"}),(0,u.jsx)("strong",{children:null!==(n=p.failureCount)&&void 0!==n?n:0})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{children:"Avg Duration"}),(0,u.jsxs)("strong",{children:[Math.round(null!==(i=p.averageDurationMs)&&void 0!==i?i:0)," ms"]})]})]})]}),(0,u.jsxs)("section",{className:"admin-model__logs",children:[(0,u.jsxs)("div",{className:"admin-model__logs-header",children:[(0,u.jsx)("h2",{children:"Model Activity"}),(0,u.jsxs)("button",{type:"button",className:"inline-btn inline-btn--ghost",onClick:()=>window.location.reload(),children:[(0,u.jsx)(t.KP4,{})," Refresh"]})]}),0===g.length?(0,u.jsx)("p",{className:"muted",children:"No model invocations recorded yet."}):(0,u.jsx)("div",{className:"admin-model__log-list",children:g.map(e=>{const s=k===e._id;return(0,u.jsxs)("article",{className:"admin-model__log".concat("error"===e.status?" admin-model__log--error":""),children:[(0,u.jsxs)("button",{type:"button",className:"admin-model__log-header",onClick:()=>A(s?null:e._id),children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{children:"success"===e.status?"Prediction Success":"Prediction Error"}),(0,u.jsxs)("p",{children:["Student ID: ",e.userId||"\u2014"]})]}),(0,u.jsxs)("div",{className:"admin-model__log-meta",children:[(0,u.jsx)("span",{children:m(e.createdAt)}),(0,u.jsxs)("span",{children:[Math.round(e.durationMs||0)," ms"]})]})]}),s&&(0,u.jsxs)("div",{className:"admin-model__log-body",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{children:"Feature Vector"}),(0,u.jsx)("pre",{children:JSON.stringify(e.featureVector,null,2)})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{children:"Model Feedback"}),"success"===e.status?(0,u.jsx)("pre",{children:JSON.stringify(e.prediction,null,2)}):(0,u.jsx)("p",{className:"muted",children:e.errorMessage||"Unknown error"})]})]})]},e._id)})})]})]})}}}]);
//# sourceMappingURL=446.797ac35f.chunk.js.map