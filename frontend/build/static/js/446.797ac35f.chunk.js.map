{"version":3,"file":"static/js/446.797ac35f.chunk.js","mappings":"oOAQA,MAAMA,EAAcC,GAAWA,EAAQ,IAAIC,KAAKD,GAAOE,iBAAmB,SAqJ1E,QAnJA,WAAuB,IAADC,EAAAC,EAAAC,EAAAC,EACpB,MAAM,KAAEC,IAASC,EAAAA,EAAAA,KACXC,GAAWC,EAAAA,EAAAA,OACVC,EAAQC,IAAaC,EAAAA,EAAAA,UAAS,CAAEC,SAAS,EAAOC,UAAW,KAAMC,QAAS,MAC1EC,EAAMC,IAAWL,EAAAA,EAAAA,UAAS,KAC1BM,EAASC,IAAcP,EAAAA,EAAAA,UAAS,OAChCQ,EAASC,IAAcT,EAAAA,EAAAA,WAAS,IAChCU,EAAeC,IAAoBX,EAAAA,EAAAA,UAAS,OAEnDY,EAAAA,EAAAA,WAAU,KACR,GAAuB,WAAf,OAAJlB,QAAI,IAAJA,OAAI,EAAJA,EAAMmB,UAGR,OAFAC,EAAAA,GAAMC,MAAM,4BACZnB,EAAS,QAAS,CAAEoB,SAAS,IAI/B,IAAIC,GAAS,EACb,MAAMC,EAAYC,UAChBV,GAAW,GACX,IACE,OAASW,KAAMC,IAAgBD,KAAME,UAAoBC,QAAQC,IAAI,CACnEC,EAAAA,EAAIC,IAAI,iBACRD,EAAAA,EAAIC,IAAI,uBAEV,IAAKT,EAAQ,OACblB,EAAUsB,GACVhB,EAAQsB,MAAMC,QAAQN,EAASlB,MAAQkB,EAASlB,KAAO,IACvDG,EAAWe,EAAShB,SAAW,KACjC,CAAE,MAAOuB,GAAM,IAADC,EAAAC,EACZ,IAAKd,EAAQ,OACbH,EAAAA,GAAMC,OAAkB,QAAZe,EAAAD,EAAIG,gBAAQ,IAAAF,GAAM,QAANC,EAAZD,EAAcV,YAAI,IAAAW,OAAN,EAAZA,EAAoBhB,QAAS,+BAC3C,CAAC,QACKE,GAAQR,GAAW,EACzB,GAEFS,IACA,MAAMe,EAAWC,YAAYhB,EAAW,KACxC,MAAO,KACLD,GAAS,EACTkB,cAAcF,KAEf,CAAK,OAAJvC,QAAI,IAAJA,OAAI,EAAJA,EAAMmB,SAAUjB,IAEpB,MAAMwC,GAAcC,EAAAA,EAAAA,SAAQ,IACrBvC,EACEA,EAAOG,QAAU,gBAAkB,gBADtB,UAEnB,CAACH,IAEJ,OAAIU,GAEA8B,EAAAA,EAAAA,KAAA,OAAKC,UAAU,4CAA2CC,UACxDF,EAAAA,EAAAA,KAACG,IAAU,CAACC,MAAM,UAAUC,KAAM,QAMtCC,EAAAA,EAAAA,MAAA,OAAKL,UAAU,cAAaC,SAAA,EAC1BI,EAAAA,EAAAA,MAAA,UAAQL,UAAU,sBAAqBC,SAAA,EACrCI,EAAAA,EAAAA,MAAA,OAAKL,UAAS,sBAAAM,OAAwB/C,EAAOG,QAAU,+BAAiC,iCAAkCuC,SAAA,EACxHF,EAAAA,EAAAA,KAACQ,EAAAA,IAAQ,KACTF,EAAAA,EAAAA,MAAA,OAAAJ,SAAA,EACEF,EAAAA,EAAAA,KAAA,UAAAE,SAASJ,KACTQ,EAAAA,EAAAA,MAAA,QAAAJ,SAAA,CAAM,WAAStD,EAAWY,EAAOI,cAChCJ,EAAOK,UAAWmC,EAAAA,EAAAA,KAAA,SAAAE,SAAQ1C,EAAOK,gBAGrCG,IACCsC,EAAAA,EAAAA,MAAA,OAAKL,UAAU,uBAAsBC,SAAA,EACnCI,EAAAA,EAAAA,MAAA,OAAAJ,SAAA,EACEF,EAAAA,EAAAA,KAAA,QAAAE,SAAM,oBACNF,EAAAA,EAAAA,KAAA,UAAAE,SAA8B,QAA9BlD,EAASgB,EAAQyC,qBAAa,IAAAzD,EAAAA,EAAI,QAEpCsD,EAAAA,EAAAA,MAAA,OAAAJ,SAAA,EACEF,EAAAA,EAAAA,KAAA,QAAAE,SAAM,aACNF,EAAAA,EAAAA,KAAA,UAAAE,SAA6B,QAA7BjD,EAASe,EAAQ0C,oBAAY,IAAAzD,EAAAA,EAAI,QAEnCqD,EAAAA,EAAAA,MAAA,OAAAJ,SAAA,EACEF,EAAAA,EAAAA,KAAA,QAAAE,SAAM,cACNF,EAAAA,EAAAA,KAAA,UAAAE,SAA6B,QAA7BhD,EAASc,EAAQ2C,oBAAY,IAAAzD,EAAAA,EAAI,QAEnCoD,EAAAA,EAAAA,MAAA,OAAAJ,SAAA,EACEF,EAAAA,EAAAA,KAAA,QAAAE,SAAM,kBACNI,EAAAA,EAAAA,MAAA,UAAAJ,SAAA,CAASU,KAAKC,MAA+B,QAA1B1D,EAACa,EAAQ8C,yBAAiB,IAAA3D,EAAAA,EAAI,GAAG,mBAM5DmD,EAAAA,EAAAA,MAAA,WAASL,UAAU,oBAAmBC,SAAA,EACpCI,EAAAA,EAAAA,MAAA,OAAKL,UAAU,2BAA0BC,SAAA,EACvCF,EAAAA,EAAAA,KAAA,MAAAE,SAAI,oBACJI,EAAAA,EAAAA,MAAA,UAAQS,KAAK,SAASd,UAAU,+BAA+Be,QAASA,IAAMC,OAAOC,SAASC,SAASjB,SAAA,EACrGF,EAAAA,EAAAA,KAACoB,EAAAA,IAAS,IAAG,iBAGA,IAAhBtD,EAAKuD,QACJrB,EAAAA,EAAAA,KAAA,KAAGC,UAAU,QAAOC,SAAC,wCAErBF,EAAAA,EAAAA,KAAA,OAAKC,UAAU,wBAAuBC,SACnCpC,EAAKwD,IAAKC,IACT,MAAMC,EAAapD,IAAkBmD,EAAIE,IACzC,OACEnB,EAAAA,EAAAA,MAAA,WAEEL,UAAS,mBAAAM,OAAoC,UAAfgB,EAAI/D,OAAqB,2BAA6B,IAAK0C,SAAA,EAEzFI,EAAAA,EAAAA,MAAA,UACES,KAAK,SACLd,UAAU,0BACVe,QAASA,IAAM3C,EAAiBmD,EAAa,KAAOD,EAAIE,KAAKvB,SAAA,EAE7DI,EAAAA,EAAAA,MAAA,OAAAJ,SAAA,EACEF,EAAAA,EAAAA,KAAA,MAAAE,SAAoB,YAAfqB,EAAI/D,OAAuB,qBAAuB,sBACvD8C,EAAAA,EAAAA,MAAA,KAAAJ,SAAA,CAAG,eAAaqB,EAAIG,QAAU,gBAEhCpB,EAAAA,EAAAA,MAAA,OAAKL,UAAU,wBAAuBC,SAAA,EACpCF,EAAAA,EAAAA,KAAA,QAAAE,SAAOtD,EAAW2E,EAAII,cACtBrB,EAAAA,EAAAA,MAAA,QAAAJ,SAAA,CAAOU,KAAKC,MAAMU,EAAIK,YAAc,GAAG,eAG1CJ,IACClB,EAAAA,EAAAA,MAAA,OAAKL,UAAU,wBAAuBC,SAAA,EACpCI,EAAAA,EAAAA,MAAA,OAAAJ,SAAA,EACEF,EAAAA,EAAAA,KAAA,QAAAE,SAAM,oBACNF,EAAAA,EAAAA,KAAA,OAAAE,SAAM2B,KAAKC,UAAUP,EAAIQ,cAAe,KAAM,SAEhDzB,EAAAA,EAAAA,MAAA,OAAAJ,SAAA,EACEF,EAAAA,EAAAA,KAAA,QAAAE,SAAM,mBACU,YAAfqB,EAAI/D,QACHwC,EAAAA,EAAAA,KAAA,OAAAE,SAAM2B,KAAKC,UAAUP,EAAIS,WAAY,KAAM,MAE3ChC,EAAAA,EAAAA,KAAA,KAAGC,UAAU,QAAOC,SAAEqB,EAAIU,cAAgB,0BA5B7CV,EAAIE,cAyC3B,C","sources":["AdminModel.js"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport ClipLoader from 'react-spinners/ClipLoader';\nimport { toast } from 'react-toastify';\nimport { FaServer, FaSyncAlt } from 'react-icons/fa';\nimport api from './api';\nimport { useAuth } from './context/AuthContext';\n\nconst formatDate = (value) => (value ? new Date(value).toLocaleString() : '—');\n\nfunction AdminModel() {\n  const { user } = useAuth();\n  const navigate = useNavigate();\n  const [status, setStatus] = useState({ running: false, checkedAt: null, message: '' });\n  const [logs, setLogs] = useState([]);\n  const [metrics, setMetrics] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [expandedLogId, setExpandedLogId] = useState(null);\n\n  useEffect(() => {\n    if (user?.userType !== 'Admin') {\n      toast.error('Administrators only');\n      navigate('/home', { replace: true });\n      return;\n    }\n\n    let active = true;\n    const fetchData = async () => {\n      setLoading(true);\n      try {\n        const [{ data: statusData }, { data: logsData }] = await Promise.all([\n          api.get('/model/status'),\n          api.get('/admin/model/logs')\n        ]);\n        if (!active) return;\n        setStatus(statusData);\n        setLogs(Array.isArray(logsData.logs) ? logsData.logs : []);\n        setMetrics(logsData.metrics || null);\n      } catch (err) {\n        if (!active) return;\n        toast.error(err.response?.data?.error || 'Failed to load model metrics');\n      } finally {\n        if (active) setLoading(false);\n      }\n    };\n    fetchData();\n    const interval = setInterval(fetchData, 20000);\n    return () => {\n      active = false;\n      clearInterval(interval);\n    };\n  }, [user?.userType, navigate]);\n\n  const statusLabel = useMemo(() => {\n    if (!status) return 'Unknown';\n    return status.running ? 'Model Running' : 'Model Offline';\n  }, [status]);\n\n  if (loading) {\n    return (\n      <div className=\"admin-model admin-teacher-detail--loading\">\n        <ClipLoader color=\"#14b8a6\" size={48} />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"admin-model\">\n      <header className=\"admin-model__header\">\n        <div className={`admin-model__status${status.running ? ' admin-model__status--online' : ' admin-model__status--offline'}`}>\n          <FaServer />\n          <div>\n            <strong>{statusLabel}</strong>\n            <span>Checked {formatDate(status.checkedAt)}</span>\n            {status.message && <small>{status.message}</small>}\n          </div>\n        </div>\n        {metrics && (\n          <div className=\"admin-model__metrics\">\n            <div>\n              <span>Total Requests</span>\n              <strong>{metrics.totalRequests ?? 0}</strong>\n            </div>\n            <div>\n              <span>Success</span>\n              <strong>{metrics.successCount ?? 0}</strong>\n            </div>\n            <div>\n              <span>Failures</span>\n              <strong>{metrics.failureCount ?? 0}</strong>\n            </div>\n            <div>\n              <span>Avg Duration</span>\n              <strong>{Math.round(metrics.averageDurationMs ?? 0)} ms</strong>\n            </div>\n          </div>\n        )}\n      </header>\n\n      <section className=\"admin-model__logs\">\n        <div className=\"admin-model__logs-header\">\n          <h2>Model Activity</h2>\n          <button type=\"button\" className=\"inline-btn inline-btn--ghost\" onClick={() => window.location.reload()}>\n            <FaSyncAlt /> Refresh\n          </button>\n        </div>\n        {logs.length === 0 ? (\n          <p className=\"muted\">No model invocations recorded yet.</p>\n        ) : (\n          <div className=\"admin-model__log-list\">\n            {logs.map((log) => {\n              const isExpanded = expandedLogId === log._id;\n              return (\n                <article\n                  key={log._id}\n                  className={`admin-model__log${log.status === 'error' ? ' admin-model__log--error' : ''}`}\n                >\n                  <button\n                    type=\"button\"\n                    className=\"admin-model__log-header\"\n                    onClick={() => setExpandedLogId(isExpanded ? null : log._id)}\n                  >\n                    <div>\n                      <h3>{log.status === 'success' ? 'Prediction Success' : 'Prediction Error'}</h3>\n                      <p>Student ID: {log.userId || '—'}</p>\n                    </div>\n                    <div className=\"admin-model__log-meta\">\n                      <span>{formatDate(log.createdAt)}</span>\n                      <span>{Math.round(log.durationMs || 0)} ms</span>\n                    </div>\n                  </button>\n                  {isExpanded && (\n                    <div className=\"admin-model__log-body\">\n                      <div>\n                        <span>Feature Vector</span>\n                        <pre>{JSON.stringify(log.featureVector, null, 2)}</pre>\n                      </div>\n                      <div>\n                        <span>Model Feedback</span>\n                        {log.status === 'success' ? (\n                          <pre>{JSON.stringify(log.prediction, null, 2)}</pre>\n                        ) : (\n                          <p className=\"muted\">{log.errorMessage || 'Unknown error'}</p>\n                        )}\n                      </div>\n                    </div>\n                  )}\n                </article>\n              );\n            })}\n          </div>\n        )}\n      </section>\n    </div>\n  );\n}\n\nexport default AdminModel;\n\n"],"names":["formatDate","value","Date","toLocaleString","_metrics$totalRequest","_metrics$successCount","_metrics$failureCount","_metrics$averageDurat","user","useAuth","navigate","useNavigate","status","setStatus","useState","running","checkedAt","message","logs","setLogs","metrics","setMetrics","loading","setLoading","expandedLogId","setExpandedLogId","useEffect","userType","toast","error","replace","active","fetchData","async","data","statusData","logsData","Promise","all","api","get","Array","isArray","err","_err$response","_err$response$data","response","interval","setInterval","clearInterval","statusLabel","useMemo","_jsx","className","children","ClipLoader","color","size","_jsxs","concat","FaServer","totalRequests","successCount","failureCount","Math","round","averageDurationMs","type","onClick","window","location","reload","FaSyncAlt","length","map","log","isExpanded","_id","userId","createdAt","durationMs","JSON","stringify","featureVector","prediction","errorMessage"],"sourceRoot":""}